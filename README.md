# solartron-multistat-mdat-extractor
 Solartron MultiStat (.mdat) é˜»æŠ—æ•°æ®æ‰¹é‡æå–è„šæœ¬

A Python script to batch process Electrochemical Impedance Spectroscopy (EIS) data files generated by **Solartron MultiStat** software, often used with the **1470E / 1400 series** instruments.

This script directly reads the compressed `.mdat` files, finds all AC impedance data, and extracts the key columns (Frequency, Z_real, Z_imag) into clean `.csv` and `.txt` files.

è¿™æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œç”¨äºæ‰¹é‡å¤„ç†ç”± **Solartron MultiStat** è½¯ä»¶ï¼ˆé€šå¸¸ä¸ **1470E / 1400 ç³»åˆ—**ç”µåŒ–å­¦å·¥ä½œç«™é…å¥—ä½¿ç”¨ï¼‰ç”Ÿæˆçš„ç”µåŒ–å­¦é˜»æŠ—è°± (EIS) æ•°æ®ã€‚

æœ¬è„šæœ¬**æ— éœ€äºŒæ¬¡å¯¼å‡º**ï¼Œå¯ç›´æ¥è¯»å–åŸå§‹çš„ `.mdat` å‹ç¼©æ–‡ä»¶ï¼Œè‡ªåŠ¨æŸ¥æ‰¾å…¶ä¸­æ‰€æœ‰çš„ AC é˜»æŠ—æ•°æ®ï¼Œå¹¶å°†æ ¸å¿ƒæ•°æ®ï¼ˆé¢‘ç‡, å®éƒ¨, è™šéƒ¨ï¼‰æå–å¹¶ä¿å­˜ä¸ºå¹²å‡€çš„ `.csv` å’Œ `.txt` æ–‡ä»¶ã€‚

---

## ğŸš© The Problem (é—®é¢˜æ‰€åœ¨)

The MultiStat software saves data in a compressed `.mdat` format. While this file can be opened in the "MultiStat Data Explorer" or "ZView" for *viewing*, exporting data for further analysis (like DRT, fitting, or plotting in Origin/Python) is extremely difficult.

The standard workflow is:
1.  Open *each* `.mdat` file in ZView.
2.  Manually find the specific AC dataset.
3.  Click "Data Values" to open the table.
4.  Manually copy and paste the data into Excel or Origin.
5.  Repeat this process for *every single file*.

This workflow is slow, tedious, and makes **batch processing impossible**.

---

MultiStat è½¯ä»¶å°†æ•°æ®ä¿å­˜åœ¨ `.mdat` å‹ç¼©æ ¼å¼ä¸­ã€‚è™½ç„¶å¯ä»¥åœ¨ "MultiStat Data Explorer" æˆ– "ZView" ä¸­ *é¢„è§ˆ* æ•°æ®ï¼Œä½†è¦å°†å…¶å¯¼å‡ºä»¥è¿›è¡Œè¿›ä¸€æ­¥åˆ†æï¼ˆä¾‹å¦‚ DRT åˆ†æã€ç­‰æ•ˆç”µè·¯æ‹Ÿåˆï¼Œæˆ–åœ¨ Origin/Python ä¸­ç»˜å›¾ï¼‰å´éå¸¸å›°éš¾ã€‚

æ ‡å‡†çš„å·¥ä½œæµç¨‹æ˜¯ï¼š
1.  åœ¨ ZView ä¸­ *é€ä¸ª* æ‰“å¼€ `.mdat` æ–‡ä»¶ã€‚
2.  æ‰‹åŠ¨æ‰¾åˆ°ç‰¹å®šçš„ AC æ•°æ®é›†ã€‚
3.  ç‚¹å‡» "Data Values" æ‰“å¼€æ•°æ®è¡¨ã€‚
4.  æ‰‹åŠ¨å¤åˆ¶æ•°æ®ï¼Œç„¶åç²˜è´´åˆ° Excel æˆ– Origin ä¸­ã€‚
5.  å¯¹ *æ¯ä¸€ä¸ª* æ–‡ä»¶é‡å¤æ­¤æ“ä½œã€‚

è¿™ä¸ªæµç¨‹æå…¶ç¼“æ…¢ã€ç¹çï¼Œä¸”**æ— æ³•å®ç°æ‰¹é‡å¤„ç†**ã€‚

## ğŸ’¡ The Solution (è§£å†³æ–¹æ¡ˆ)

This script automates the entire process. Based on the official documentation, `.mdat` files are simply **ZIP archives**.

This script treats each `.mdat` file as a ZIP file, reads it in memory, and automatically finds all internal AC data sub-files (typically `.z` files). It then parses the ASCII header within each sub-file to locate and extract the data, saving it as universally compatible `.csv` and `.txt` files.

---

æœ¬è„šæœ¬å°†æ•´ä¸ªè¿‡ç¨‹å®Œå…¨è‡ªåŠ¨åŒ–ã€‚åŸºäºå®˜æ–¹æ–‡æ¡£ï¼Œ`.mdat` æ–‡ä»¶æœ¬è´¨ä¸Šå°±æ˜¯ **ZIP å‹ç¼©åŒ…**ã€‚

æœ¬è„šæœ¬å°†æ¯ä¸ª `.mdat` æ–‡ä»¶ä½œä¸º ZIP å‹ç¼©åŒ…åœ¨å†…å­˜ä¸­è¯»å–ï¼Œè‡ªåŠ¨æŸ¥æ‰¾å‹ç¼©åŒ…å†…æ‰€æœ‰çš„ AC æ•°æ®å­æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ `.z` æ–‡ä»¶ï¼‰ã€‚ç„¶åï¼Œå®ƒä¼šè§£ææ¯ä¸ªå­æ–‡ä»¶ä¸­çš„ ASCII æ–‡æœ¬å¤´ä¿¡æ¯ï¼Œç²¾ç¡®å®šä½å¹¶æå–æ•°æ®ã€‚

æœ€åï¼Œè„šæœ¬ä¼šå°†å¹²å‡€çš„æ•°æ®ä¿å­˜ä¸º**ä¸¤ç§**é€šç”¨æ ¼å¼ï¼š
* **`.csv`** (é€—å·åˆ†éš”)
* **`.txt`** (åˆ¶è¡¨ç¬¦åˆ†éš”, `\t`) - è¿™ç§æ ¼å¼ä¸ Origin, MATLAB å’Œå…¶ä»–ç§‘å­¦ç»˜å›¾è½¯ä»¶çš„å…¼å®¹æ€§æä½³ã€‚

## âœ¨ Features (åŠŸèƒ½ç‰¹æ€§)

* **No Secondary Export:** Directly reads raw `.mdat` files. **No ZView or MultiStat needed.**
* **Batch Processing:** Processes all `.mdat` files in a specified input folder.
* **Handles Complex Files:** Correctly extracts data from `.mdat` files containing multiple runs, steps, or cycles.
* **Smart Parsing:** Automatically locates data headers (`Freq(Hz)`, `Z'(a)`, `Z''(b)`) based on the `End Header:` marker.
* **Data Normalization:** Automatically converts the imaginary part (`Z''(b)`) to its absolute (positive) value, which is required by most analysis software (like DRT).
* **Dual Format Output:** Saves data as both `.csv` and `.txt` (tab-separated) for maximum compatibility.

---

* **æ— éœ€äºŒæ¬¡å¯¼å‡º:** ç›´æ¥è¯»å– `.mdat` åŸå§‹æ–‡ä»¶ï¼Œ**æ— éœ€å®‰è£… ZView æˆ– MultiStat**ã€‚
* **æ‰¹é‡å¤„ç†:** è‡ªåŠ¨æ‰«æè¾“å…¥æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰ `.mdat` æ–‡ä»¶å¹¶ä¸€æ¬¡æ€§å¤„ç†ã€‚
* **å¤„ç†å¤æ‚æ–‡ä»¶:** å³ä½¿ `.mdat` æ–‡ä»¶åŒ…å«å¤šæ¬¡è¿è¡Œ (Runs) æˆ–å¤šä¸ªæ­¥éª¤ (Steps)ï¼Œä¹Ÿèƒ½æ­£ç¡®æå–æ‰€æœ‰ AC æ•°æ®ã€‚
* **æ™ºèƒ½è§£æ:** åŸºäº `End Header:` æ ‡è®°è‡ªåŠ¨å®šä½æ•°æ®å¤´ï¼ˆ`Freq(Hz)`, `Z'(a)`, `Z''(b)`ï¼‰ã€‚
* **åŒæ ¼å¼è¾“å‡º:** åŒæ—¶ä¿å­˜ä¸º `.csv` å’Œ `.txt` (åˆ¶è¡¨ç¬¦åˆ†éš”)ï¼Œä»¥å®ç°æœ€ä½³å…¼å®¹æ€§ã€‚

## ğŸ”§ How to Use (ä½¿ç”¨æ–¹æ³•)

### 1. Prerequisites (ç¯å¢ƒè¦æ±‚)

* Python 3.x
* Pandas library

Install Pandas if you don't have it:
```bash
pip install pandas
